<h2>App: <%= @app.name %></h2>

<dl class="stats dl-horizontal">
  <dt>Last signal:</dt><dd><%= signal_type @app.current_signal %></dd>
  <dt>Stability score: </dt><dd><%= app_stability_score @app.stats %></dd>
</dl>

<section>
  <h3>Signals</h3>
  <%= column_chart @app.signals.recent(50).group_by{ |s| s.state }.map{ |state, signals|
    { name: state, data: signals.sort_by(&:created_at).group_by{ |s| s.created_at.to_date }.map{ |date, signals|
      [date, signals.count] }
    }
  } %>
</section>

<section>
  <h3>Distance between signals</h3>
  <% data = @app.signals.recent(50).each_cons(2).map do |sig1, sig2|
    [sig2.created_at.to_s, sig2.created_at - sig1.created_at]
  end %>
  <%= line_chart data %>
</section>


<%= render partial: 'gingerr/signals/table', locals: { signals: @signals, title: 'Recent signals' } %>
